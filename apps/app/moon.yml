fileGroups:
  qwik:
    - 'src/**/*'
    - 'adapters/**/*'
    - 'vite.config.ts'

tasks:
  build:
    command: noop
    deps:
      - '~:build-client'
      - '~:build-server'
    options:
      runDepsInParallel: false

  build-client:
    command: 'vite build'
    inputs:
      - '@group(qwik)'
    outputs:
      - 'dist'

  build-server:
    command: vite
    args:
      - build
      - '--config'
      - 'adapters/static/vite.config.ts'
    inputs:
      - '@group(qwik)'
    outputs:
      - 'server'
      - 'dist'

  dev:
    command: vite
    args:
      - '--mode'
      - 'ssr'
      - '--host'
      - '--port'
      - '3000'
    local: true
